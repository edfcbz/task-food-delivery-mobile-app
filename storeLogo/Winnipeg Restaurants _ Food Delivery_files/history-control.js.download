window.skipthedishes.HistoryControl=function(skipLoading){function _reloadIfBfCached(){$(window).on("pageshow",function(e){e.persisted||e.originalEvent&&e.originalEvent.persisted?(skipLoading.showLoading(!0),$(".modal").modal("hide"),window.location.reload(),"function"==typeof _bfCachedCallback&&_bfCachedCallback()):"function"==typeof _notBfCachedCallback&&_notBfCachedCallback()})}function _goBackInHistory(index){history.go(index||0===index?index:-1)}function _assignBackUrl(backUrl){backUrl&&location.assign(backUrl)}function _goBack(params){history.length>1&&!params.forceAssign?_goBackInHistory(params.index):_assignBackUrl(params.backUrl)}function _hijackBackNavigation(params){$(document).ready(function(){var historyLength=history.length;$(params.selector).toggleClass("hidden",!(params.backUrl&&historyLength>1)).on("click",function(){_goBack({backUrl:params.backUrl,forceAssign:!history.pushState})}),history.pushState&&(history.replaceState(_BACK_NAVIGATION,null),history.pushState(null,null),$(window).on("popstate",function(e){var state=e.originalEvent?e.originalEvent.state:e.state;state===_BACK_NAVIGATION&&(history.replaceState(null,null),_goBack({backUrl:params.backUrl,index:params.index,forceAssign:params.forceAssign}))}))})}var _bfCachedCallback,_notBfCachedCallback,_BACK_NAVIGATION="backNavigation";return{reloadIfBfCached:function(){_reloadIfBfCached()},setBfCachedCallback:function(callback){_bfCachedCallback=callback},setNotBfCachedCallback:function(callback){_notBfCachedCallback=callback},goBack:function(params){_goBack(params)},hijackBackNavigation:function(params){_hijackBackNavigation(params)}}}(window.skipthedishes.Loading);