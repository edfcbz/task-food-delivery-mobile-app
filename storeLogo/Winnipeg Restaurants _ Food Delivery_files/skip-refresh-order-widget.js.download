window.skipthedishes.reloadPage=!1,window.skipthedishes=window.skipthedishes||{},window.skipthedishes.OrderWidget=function($,skipAlerts,skipLoading,navDropdowns,googleMap){function _showAlertMessage(type,message){skipAlerts.showTopAlert(type,message,!0)}var _$addressDeleteConfirm,_$addressDeleteCancel,_$addressListSection,_$addressAddSection,_$orderDatesSelect,_$orderTimesSelect,_$addressListView,_$addressAddView,_$deliveryButton,_$addressDelete,_$pickupButton,_$addressForm,_orderDatesSelectElementClass,_orderTimesSelectElementClass,_deleteAddressConfirmSelector,_orderTimesSelectSelector,_restaurantListUpdateUrl,_addressInputSelector,_listItemSelector,_ajaxUrl,DANGER="danger";return{init:function(params){_$orderDatesSelect=$(params.orderDateInputSelector),_orderTimesSelectSelector=params.orderTimeInputSelector,_$orderTimesSelect=$(_orderTimesSelectSelector),_$deliveryButton=$(params.deliveryButtonSelector),_$pickupButton=$(params.pickupButtonSelector),_restaurantListUpdateUrl=params.restaurantListUpdateUrl,_orderDatesSelectElementClass=params.orderDatesSelectElementClass,_orderTimesSelectElementClass=params.orderTimesSelectElementClass,_ajaxUrl=params.ajaxUrl,_$addressForm=$(params.addressFormSelector),_addressInputSelector=params.addressInputSelector,_deleteAddressConfirmSelector=params.deleteAddressConfirmSelector,_$addressListSection=$(params.addressListSectionSelector),_$addressAddSection=$(params.addressAddSectionSelector),_$addressDeleteConfirm=$(params.addressDeleteConfirmSelector),_$addressDeleteCancel=$(params.addressDeleteCancelSelector),_$addressDelete=$(params.addressDeleteSelector),_listItemSelector=params.listItemSelector,_$addressAddView=$(params.addressAddViewSelector),_$addressListView=$(params.addressListViewSelector),_$addressDeleteConfirm.click(function(){var _$listItem=$(this).closest(_listItemSelector);$(_deleteAddressConfirmSelector).addClass("hidden"),_$listItem.find(_deleteAddressConfirmSelector).removeClass("hidden"),_$listItem.removeClass("faded-out"),_$listItem.siblings().addClass("faded-out"),navDropdowns.updateDropdownMenuHeight()}),_$addressDeleteCancel.click(function(){$(_deleteAddressConfirmSelector).addClass("hidden"),$(this).closest(_listItemSelector).siblings().removeClass("faded-out"),navDropdowns.updateDropdownMenuHeight()}),_$addressDelete.click(function(){var $this=$(this),_$listItem=$this.closest(_listItemSelector),url=(_$listItem.data("address"),$this.data("url")),postData={};skipLoading.showLoading(!0),$.post(url,postData,function(data){data.successMessage?(_$listItem.siblings().removeClass("faded-out"),_$listItem.remove(),setTimeout(navDropdowns.updateDropdownMenuHeight,500)):data.errorMessage&&skipAlerts.showTopAlert(DANGER,data.errorMessage,!0)}).fail(function(){skipAlerts.showTopAlert(DANGER,"There was a problem deleting your address.",!0)}).always(function(){skipLoading.showLoading(!1)})}),_$addressAddView.click(function(){var $addressAutocomplete=$(params.addressAutocompleteSelector);_$addressListSection.addClass("hidden"),_$addressAddSection.removeClass("hidden"),$addressAutocomplete.parent().find("input").val(""),$addressAutocomplete.focus(),navDropdowns.updateDropdownMenuHeight()}),_$addressListView.click(function(){_$addressAddSection.addClass("hidden"),_$addressListSection.removeClass("hidden"),$(params.addressErrorSelector).addClass("hidden"),$(params.googleMapContainerSelector).addClass("hidden"),navDropdowns.updateDropdownMenuHeight()}),0==_$addressListSection.find(_listItemSelector).length&&_$addressAddView.click(),$(document).on("change",_addressInputSelector,function(){var $selected=$(_addressInputSelector+":checked"),address=$selected.data("address"),addressObject={address:address,address_id:$selected.data("address-id"),city:$selected.data("city"),latitude:$selected.data("latitude"),longitude:$selected.data("longitude"),google_street_address:address,google_postal_code:$selected.data("postal-code"),province:$selected.data("province"),accuracy:$selected.data("accuracy")};for(var property in addressObject)addressObject.hasOwnProperty(property)&&_$addressForm.find('input[name="'+property+'"]').val(addressObject[""+property]);skipLoading.showLoading(!0),$.post(_ajaxUrl,addressObject,function(data){if(data.errorMessage)_showAlertMessage(data.errorMessage);else if(window.location.href.indexOf("restaurants")!==-1){var city=data.city.replace(" ","-").toLowerCase();window.location.href="/"+city+"/restaurants"}else window.location.href=window.location.href}).fail(function(){skipAlerts.showTopAlert(DANGER,"Something went wrong. Please try again.",!0),skipLoading.showLoading(!1)})}),$(document).ready(function(){$deviceMd=$(params.deviceSelectors.md),$deviceLg=$(params.deviceSelectors.lg);var scrollToSelectedTimeOffset=0,scrollToSelectedTimeOffsetList=$(_orderTimesSelectElementClass+" input[checked]").closest(_orderTimesSelectElementClass).prevAll(_orderTimesSelectElementClass);$.each(scrollToSelectedTimeOffsetList,function(){scrollToSelectedTimeOffset+=$(this).height()}),_$orderTimesSelect.scrollTop(scrollToSelectedTimeOffset),_$orderTimesSelect.find(_orderTimesSelectElementClass).change(function(){var order_time=$(this).find("input").val(),postData={order_time:order_time};skipLoading.showLoading(!0),$.post(_restaurantListUpdateUrl,postData,function(){window.location.reload(!0)}).fail(function(){_showAlertMessage(DANGER,"Something Went Wrong. Please try again."),skipLoading.showLoading(!1)})}),_$deliveryButton.add(_$pickupButton).click(function(){if(!$(this).hasClass("btn-method btn-primary")){var orderType=$(this).data("order-type").toLowerCase();_$deliveryButton.add(_$pickupButton).filter(".btn-method").toggleClass("btn-primary btn-lighter active"),skipLoading.showLoading(!0),$.post(_restaurantListUpdateUrl,{order_type:orderType},function(){window.location.reload(!0)}).fail(function(){_$deliveryButton.add(_$pickupButton).filter(".btn-method").toggleClass("btn-primary btn-lighter active"),_showAlertMessage(DANGER,"Something Went Wrong. Please try again."),skipLoading.showLoading(!1)})}}),_$orderDatesSelect.find(_orderDatesSelectElementClass).click(function(){$(this).hasClass("active")||($(this).addClass("active").siblings().removeClass("active"),_$orderTimesSelect.addClass("hidden"),$(_orderTimesSelectSelector+'[data-day="'+$(this).data("day")+'"]').removeClass("hidden"))}),!params.inaccurateLocation&&params.navBarMobileStaticGoogleMapLatitude&&params.navBarMobileStaticGoogleMapLongitude&&$(params.navBarMobileSelector).one("click",function(){var staticMapParams={showLoader:!0,$container:$(params.navBarMobileStaticGoogleMapSelector),latitude:params.navBarMobileStaticGoogleMapLatitude,longitude:params.navBarMobileStaticGoogleMapLongitude,width:params.staticGoogleMapWidth,height:params.staticGoogleMapHeight,zoom:params.staticGoogleMapsZoom,callback:function(data){$(params.addressMarkerSelector).removeClass("hidden"),data.errorMessage&&skipAlerts.showTopAlert(DANGER,data.errorMessage,!0)}};googleMap.loadStaticGoogleMaps(staticMapParams)}),$(params.orderMessageModalSelector).on("show.bs.modal",function(e){($deviceMd.is(":visible")||$deviceLg.is(":visible"))&&e.preventDefault()})})},pulseMessage:function(desktopMessageBody,mobileMessageTop,mobileMessageBody){$(mobileMessageBody).hasClass("hidden")&&$(mobileMessageTop).click();var $messageParent=$(desktopMessageBody).parent(),$messageContainter=$(desktopMessageBody).closest(".container");$messageParent.addClass("pulse-message-body"),$messageContainter.addClass("pulse-message-overlay"),setTimeout(function(){$messageParent.removeClass("pulse-message-body"),$messageContainter.removeClass("pulse-message-overlay")},1500)}}}(jQuery,window.skipthedishes.Alerts,window.skipthedishes.Loading,window.skipthedishes.NavDropdowns,window.skipthedishes.GoogleMap);